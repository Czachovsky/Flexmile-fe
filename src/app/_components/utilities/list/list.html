<div class="list">
  @if (loading()) {
    <div class="list--loader flex align-items-center justify-content-center">
      <flexmile-loader></flexmile-loader>
    </div>
  } @else {
    @if (!hideHeader() && offerList()?.offers?.length) {
      <div class="list--header pb-5 flex align-items-center justify-content-between">
        <div class="list--header-counter">
          Liczba dostępnych ofert: <span>{{ offerList()?.meta?.total ?? 0 }}</span>
        </div>
        <div>
          <flexmile-sort-by></flexmile-sort-by>
        </div>
      </div>
    }
    <div class="list--body">
      @if (!offerList()?.offers?.length) {
        <flexmile-nothing-found></flexmile-nothing-found>
      } @else {
        <div class="list--body-grid">
          @for (offer of offerList()?.offers; track trackByOfferId) {
            <flexmile-car [offer]="offer"></flexmile-car>
          }
        </div>
        <div class="list--load-more" [class.list--load-more-active]="hasMorePages() || loadingMore() || loadMoreError()">
          <div #loadMoreSentinel class="list--sentinel" aria-hidden="true"></div>
          @if (!loadingMore()) {
            <div class="list--load-more-status flex align-items-center justify-content-center">
              <flexmile-loader></flexmile-loader>
            </div>
          } @else if (loadMoreError()) {
            <div class="list--load-more-status list--load-more-error flex flex-column align-items-center">
              <p class="list--load-more-error-message text-center">
                Nie udało się pobrać kolejnych ofert.
              </p>
              <flexmile-button
                label="Spróbuj ponownie"
                color="secondary"
                size="small"
                (clicked)="retryLoadMore()">
              </flexmile-button>
            </div>
          }
        </div>
      }
    </div>
  }
</div>
