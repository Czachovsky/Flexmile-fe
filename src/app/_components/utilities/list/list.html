<div class="list">
  @if (loading()) {
    <div class="list--loader flex align-items-center justify-content-center">
      <flexmile-loader></flexmile-loader>
    </div>
  } @else {
    @if (!hideHeader() && offerList()?.offers?.length) {
      <div class="list--header pb-5 flex align-items-center justify-content-between">
        <div class="list--header-counter">
          Liczba ofert: <span>{{ offerList()?.meta?.total ?? 0 }}</span>
        </div>
        <div>
          <flexmile-sort-by></flexmile-sort-by>
        </div>
      </div>
    }
    <div class="list--body">
      @if (!offerList()?.offers?.length) {
        <flexmile-nothing-found></flexmile-nothing-found>
      } @else {
        @if (layoutItems().length) {
          <div class="list--body-grid">
            @for (item of layoutItems(); track trackByItem($index, item)) {
              @if (item.type === 'banner' && item.bannerIndex !== undefined) {
                @if (getBanner(item.bannerIndex); as banner) {
                  @if (banner) {
                    <div class="banner">
                      <flexmile-banner-list
                        [separator]="'&nbsp;'"
                        [label]="banner.label"
                        [description]="banner.description"
                        position="center">
                      </flexmile-banner-list>
                    </div>
                  }
                }
              } @else if (item.type === 'offer' && item.offer) {
                @if (item.isFullWidth) {
                  <div class="product-full">
                    <flexmile-car
                      [cardSize]="badgeSizes.LG"
                      [offer]="item.offer">
                    </flexmile-car>
                  </div>
                } @else {
                  <div class="product">
                    <flexmile-car [offer]="item.offer"></flexmile-car>
                  </div>
                }
              }
            }
          </div>
        }
        <div class="list--load-more"
             [class.list--load-more-active]="hasMorePages() || loadingMore() || loadMoreError()">
          <div #loadMoreSentinel class="list--sentinel" aria-hidden="true"></div>
          @if (loadingMore()) {
            <div class="list--load-more-status flex align-items-center justify-content-center">
              <flexmile-loader></flexmile-loader>
            </div>
          } @else if (loadMoreError()) {
            <div class="list--load-more-status list--load-more-error flex flex-column align-items-center">
              <p class="list--load-more-error-message text-center">
                Nie udało się pobrać kolejnych ofert.
              </p>
              <flexmile-button
                label="Spróbuj ponownie"
                color="secondary"
                size="small"
                (clicked)="retryLoadMore()">
              </flexmile-button>
            </div>
          }
        </div>
      }
    </div>
  }
  <div class="reserved-list">
    <flexmile-reserved-list></flexmile-reserved-list>
  </div>
</div>
